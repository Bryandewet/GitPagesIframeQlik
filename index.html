<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />
<title>Qlik JWT Embed</title>

<script type ="text/javascript">
/*
const returnToken = async () => {
const jwt = require('jsonwebtoken');
const privateKey = `-----BEGIN RSA PRIVATE KEY-----
MIIEogIBAAKCAQEAnuIoZWrDP/PjwisP9BpcnLGK2+ZepYOep4oY7/ynWp+qyApV
4XMPZCDIyX0ePPd11etu3R8WUm4mRMzlenRIeW9JKpZFTlNrcK+zOcVHLkp8DE/O
PeHIKBCf25DRPhztRv0Xsd5b3Bz+kEIFHBpKqCa6T8IMrPi9wKV1D6HOQxl8YHSe
WUpmoAcNcQNwsFKvAqCB5d3hyH1Ds9IJfxywcQz/vCn7YIIwNfoonxq8spFX6ECf
NS7353QqQXTs5lW5MdiDz/Dv2cr9NbPchX3YMHzMHxVnTyx6EEzsUeapVqvRhlUn
nUPzEjdxoBBzCScYQLKZ1SR6G6AC3rTxQpLXDwIDAQABAoIBAAwKybnS4bTGYD9A
BeS5qsZ/Ky5UXSmsuo9Dbduio2/Ai+OL62TVbhebGumXZhdQ2i/tUpwuPJut/yoi
+ks4GdYgxsOt9NeYhjTzdcetjO7HqA2qCGoZ45KSnMsgRGIYAMceOUS6vO06wib4
GgY+dLIew7hDCOe2fD6BskgN1EhMvSZ8PO5zRcj/j8SFEIVIgUhoUCvw/Z5Ujt1p
sCVL7EgJZgioHfxW1wXzE/k6YayhIvhCKsIBQfXMiqMXn7NS71W79n1j9bi7aFUG
JTiP1Cl/7UH8G7GA9Tq2aoN2tycqYAlEybYh9unGLAr+hdWrnqjQieXlj7QzlqFh
8B7dLYECgYEA2R0+iwj6FuMR+Qb4AhdakAZ3yxlL6z5MjmFxBemarr0do/F3WsMO
5ULMtTzjlPdm7hUJP9tPmkGs+bwnA0kH64xh8JBEt3O6ePq8O5re+tbW7R1z/3QQ
KrW+Xg+8UNX70XstB0CAu2epdOLAK7rt28b/C7kRIpTyA0Cyf8JtdJECgYEAu1cD
RLFmpXE64nrdcpl+W+BpQEojtv9Wae7xnITY4WFYow5Jj0ZUPOQPtPcu9zZscate
zFsGs5RKhv/44AVQ9vdM9kwKEL2UcL9QKIyFDuxXZB+d+sJr0448pme0Sq0OIRZp
Urga0cyYp571nHpOc/MAZIGc4wAZQgfcL7zk4Z8CgYBUxpyDQZAVm7iK2nPArUnJ
bx0bitcgFgVimx28x0iE7odCWqjWIdARKRIxuoLKygfA8ynXa1Ub0IUwRo2dNMkI
6pnbixmp4GBxmMYjKAflPjpR/+wpVTJy2uBobhCEJ+naFBSy/jbF9mYuo9ORv73c
0UkJVMwiCrKtHngUduCyYQKBgHVR7pgMSO3+1ROUQi5Mdddv2DoMtAUcLq+0ldah
U3kBj5K9lc+GCacAY92+lsj2aj9dRMbRkobPrUSR9PfGHIgtIyNzRzJopxdcmARs
y78mvyvSqQqqyv/3qX/EniHN8nVCJb9J0HHmoQsH/2R5K7xtR6epi+iU3Tx+06OJ
tgSdAoGAMOyf4JFim6VqJwcCwI00BCoU/AS2SX1+fsEj8VWyVASlGm/AWFPjZNVM
cKXQzrofA2CrFqX9guN0hMwMldm3H6Ktb1QN8RZV7QtY3Z589A+a+gWOIlNcZeWG
WT/SzMLRu89J1IYH5M33PAjHuvYnNlsiHp+ypou+QHL8y5ySGGo=
-----END RSA PRIVATE KEY-----`;

const clientId = 'juvz6q3bwpm2eac.eu.qlikcloud.com'; // Same as the 'iss' value
const userEmail = 'bdewet@ag.cimt.de';

const payload = {
  sub: userEmail,
  email: userEmail,
  name: "Static User",
  email_verified: true,
  iss: clientId,
  aud: "qlik.api/login/jwt-session"
};

const token = jwt.sign(payload, privateKey, {
  algorithm: 'RS256',
  expiresIn: '20m'
});

return token
};

*/
  
  let token = 'eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJiZGV3ZXRAYWcuY2ltdC5kZSIsImVtYWlsIjoiYmRld2V0QGFnLmNpbXQuZGUiLCJuYW1lIjoiU3RhdGljIFVzZXIiLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwiaXNzIjoianV2ejZxM2J3cG0yZWFjLmV1LnFsaWtjbG91ZC5jb20iLCJhdWQiOiJxbGlrLmFwaS9sb2dpbi9qd3Qtc2Vzc2lvbiIsImlhdCI6MTc0Njc5OTMzNywiZXhwIjoxNzQ2ODAwNTM3fQ.CiEWXnZjrrJ0UV8MY780YnyXf5iMB3lwAGyWVNorL3AWnwPeJ0y1UEdHCY8w4nJ8xE0z5uNTa0L2buseETcQQZv2dhLRdA5R1LRG4viA6hU4VI0USj9t-u_9bX9RUMFtk_vdI8xKEW6D2L2jcsGigvX0TSngjmP23Ms5HxVIEvoYtiJxJ2or39w_wIbgGDoX0lqjcNy0bejipyZK5rNBY9c4WPU5hPhHns--RZ7GiOAuGj3SbFjsjmBwm-3nxhicAXkgEepcoDijAgXbOie8Ec5RUkanUFiGPRyjHg9pL-GPUT2XFAgIcZz8gzlZAEOERNlCtVP_VhEEfyoM5w5GOg';
  const tenantUrl = 'https://cimt.eu.qlikcloud.com';
  const webIntegrationId = 'rmEl4GyMPGJg5zybO9bpR28nSJZt0FIE';

const login =  () => {
  if (!token) {
    console.log('Token generation failed');
    return;
  }

  try {
    const response = fetch(`${tenantUrl}/login/jwt-session`, {
      method: 'POST',
      mode: 'cors',
      credentials: 'include',
      headers: {
        'Content-Type': 'application/json',
        'qlik-web-integration-id': webIntegrationId,
        'Authorization': `Bearer ${token}`
      }
    });

    if (!response.ok) {
      throw new Error('Failed to login via JWT');
    }

    console.log('Login successful!');
  } catch (error) {
    console.error('Login error:', error);
  }
};

login();
</script>
</head>
 
  <body style="height:600px;">
<iframe
      src="https://cimt.eu.qlikcloud.com/single/?appid=c51381f5-dea9-49ff-9e4f-284dac71757d&sheet=71ec1f03-7259-492f-a393-702b752df303&select=clearall"
      style="border:none; width:100%; height:100%;"
></iframe>
</body>
</html>
