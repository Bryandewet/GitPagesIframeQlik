<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />
<title>Qlik JWT Embed</title>

<script>
  const tenantUrl = 'https://cimt.eu.qlikcloud.com';
  const webIntegrationId = 'rmEl4GyMPGJg5zybO9bpR28nSJZt0FIE';
  const jwtToken = ''; 

  async function loginToQlik() {
    try {

      const csrfResponse = await fetch(`${tenantUrl}/api/v1/csrf-token`, {
        credentials: 'include',
        headers: {
          'qlik-web-integration-id': webIntegrationId
        }
      });

      const csrfToken = csrfResponse.headers.get('qlik-csrf-token');


      const loginResponse = await fetch(`${tenantUrl}/login/jwt-session`, {
        method: 'POST',
        credentials: 'include',
        headers: {
          'qlik-web-integration-id': webIntegrationId,
          'qlik-csrf-token': csrfToken,
          'Authorization': `Bearer ${jwtToken}`
        }
      });

      if (loginResponse.ok) {
        // Success â€” redirect to the hub
        window.location.href = `${tenantUrl}/hub`;
      } else {
        const errorText = await loginResponse.text();
        console.error('Login failed:', errorText);
        alert('Login failed. Check console for details.');
      }
    } catch (err) {
      console.error('Error during login:', err);
      alert('Login error. Check console for details.');
    }
  }

  loginToQlik();
</script>
</head>
 
  <body style="height:600px;">
<iframe
      src="https://cimt.eu.qlikcloud.com/single/?appid=c51381f5-dea9-49ff-9e4f-284dac71757d&sheet=71ec1f03-7259-492f-a393-702b752df303&select=clearall"
      style="border:none; width:100%; height:100%;"
></iframe>
</body>
</html>
