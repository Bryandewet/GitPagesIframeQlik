<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />
<title>Qlik JWT Embed</title>

 <script>
    const tenantUrl = 'https://cimt.eu.qlikcloud.com';
    const webIntegrationId = 'rmEl4GyMPGJg5zybO9bpR28nSJZt0FIE';
    const jwtToken = 'eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJiZGV3ZXRAYWcuY2ltdC5kZSIsImVtYWlsIjoiYmRld2V0QGFnLmNpbXQuZGUiLCJuYW1lIjoiU3RhdGljIFVzZXIiLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwiaXNzIjoianV2ejZxM2J3cG0yZWFjLmV1LnFsaWtjbG91ZC5jb20iLCJhdWQiOiJxbGlrLmFwaS9sb2dpbi9qd3Qtc2Vzc2lvbiIsImlhdCI6MTc0Njc3MTc1NSwiZXhwIjoxNzQ2NzcyMDU1fQ.TirbDO5ntPo0D0bLrLYHNIsNwIroXBdAvvb41Ety_kaElU3Bnpmq_SxWU-pyNe8DO2XvVQdmddgrGKiMX9X7c1ZGBEKvOe-z2gMmWMaJ6T1Uxm6-lXVWEU3vYmi56Bphxqtu29xibw8WYo0EFQajYj8WpGgJu4hOMJpkt4VT0BuXiajfP3zu0p2wjyDm9KuGtvDXXJwUm8H15uuHr6KN_SVvioiZd10GLxEYjQ1mo84Lao-vzsN31sQ1L_YR3alxqRHJaW_LsJfe4RgPM8DzBWJVWpAe60BcDNVU9KS7dk-_J97nLKJrWbSRpEUTJuPRlB4rHMoI3wCAX5-1D90W5g'; 

    async function loginToQlik() {
      try {
        const csrfResponse = await fetch(`${tenantUrl}/api/v1/csrf-token`, {
          credentials: 'include',
          headers: {
            'qlik-web-integration-id': webIntegrationId
          }
        });

        const csrfToken = csrfResponse.headers.get('qlik-csrf-token');

        const loginResponse = await fetch(`${tenantUrl}/login/jwt-session`, {
          method: 'POST',
          credentials: 'include',
          headers: {
            'Content-Type': 'application/json',
            'qlik-web-integration-id': webIntegrationId,
            'qlik-csrf-token': csrfToken
          },
          body: JSON.stringify({ jwt: jwtToken })
        });

        if (loginResponse.status === 200) {
          // Login successful â€” redirect to Qlik Hub or an app
          window.location.href = `${tenantUrl}/hub`;
        } else {
          const errorText = await loginResponse.text();
          console.error('Login failed:', errorText);
          alert('Login failed. Check console for details.');
        }
      } catch (err) {
        console.error('Error during login:', err);
        alert('Login error. Check console for details.');
      }
    }

    loginToQlik();
  </script>
</head>
 
  <body style="height:600px;">
<iframe
      src="https://cimt.eu.qlikcloud.com/single/?appid=c51381f5-dea9-49ff-9e4f-284dac71757d&sheet=71ec1f03-7259-492f-a393-702b752df303&select=clearall"
      style="border:none; width:100%; height:100%;"
></iframe>
</body>
</html>
