<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Qlik JWT Embed</title>

    <script type="text/javascript">
      const webIntegrationId = "rmEl4GyMPGJg5zybO9bpR28nSJZt0FIE";

      // Replace this with your JWT token
      const jwtToken = "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJicnlhbi5kZXdldEBjaW10Lm5sIiwiZW1haWwiOiJicnlhbi5kZXdldEBjaW10Lm5sIiwibmFtZSI6IlN0YXRpYyBVc2VyIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsImlzcyI6Imp1dno2cTNid3BtMmVhYy5ldS5xbGlrY2xvdWQuY29tIiwiYXVkIjoicWxpay5hcGkvbG9naW4vand0LXNlc3Npb24iLCJpYXQiOjE3NDY2MzkyNjEsImV4cCI6MTc0NjYzOTU2MX0.meuBMjtTav2YG1TXcIn8tVKmyn9-q-EGOSrkx6p5Oe5GZ8GY0M2TSGiG2d1_NbEy0W9w5jgcaTAJ6bq8Nq7YnLIPFcyHBLRzY7cOsRwS_w-aY8DfjWXPAMTHazEoW6AviGS42iRCnjP_VhX3-V1JAF5R4aOpo8xm5Fb0Wlx7c5S34TCAPYoOcxa-lx7v--Md1EvxpaT4UKqmKG_uudU-P0ZVhIX17hnRb6SUIJs9IkANOd_9eEnI-Mq1smQmF4RohVBfTocGAm8QhWvhl2JnsmhtKQrE2t0iVNGIyxmWZwGlt-gKra-spCKKk2fBYb6QmHM_8nmIm3-0-5fB1lOuXA"; // Place your static JWT token here

      async function isLoggedIn() {
        const response = await fetch("https://cimt.eu.qlikcloud.com/api/v1/users/me", {
          method: 'GET',
          mode: 'cors',
          credentials: 'include',
          headers: {
            'Content-Type': 'application/json',
            'qlik-web-integration-id': webIntegrationId,
          },
        });
        return response.status === 200;
      }

      async function login() {
          if (jwtToken) {
            const returnTo = 'https://bryandewet.github.io/GitPagesIframeQlik/';
            const loginUrl = `https://cimt.eu.qlikcloud.com/login/jwt-session?qlik-web-integration-id=${webIntegrationId}&token=${jwtToken}&returnto=${returnTo}`;
            window.location.href = loginUrl;
          } else {
            console.error("No JWT token provided!");
          }
        }
      

      login();
    </script>
  </head>

  <body style="height:600px;">
    <iframe
      src="https://cimt.eu.qlikcloud.com/single/?appid=c51381f5-dea9-49ff-9e4f-284dac71757d&sheet=71ec1f03-7259-492f-a393-702b752df303&select=clearall"
      style="border:none; width:100%; height:100%;"
    ></iframe>
  </body>
</html>
